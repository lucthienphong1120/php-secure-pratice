## Secure user cookies

Here's how you can secure user cookies in PHP:

1. Encrypt the cookie data: Encrypt the user_id and user_type values using a secure encryption algorithm such as AES-256. This makes it difficult for an attacker to intercept and read the data stored in the cookie.
2. Add a signature: After encrypting the cookie data, add a signature to it. This signature can be generated by encoding the encrypted data with a secret key that is known only to the server. The signature serves as a check to ensure that the cookie data has not been tampered with.
3. Set the cookie options: When setting the cookie, make sure to set the options correctly. For example, set the secure option to true so that the cookie is only sent over HTTPS connections. Also, set the httponly option to true to prevent the cookie from being accessible from JavaScript, which can help protect against cross-site scripting (XSS) attacks.

Here's an example code that implements these steps:

```php
<?php

// Encrypt the user_id and user_type values
$data = [
    'user_id' => 123,
    'user_type' => 'admin'
];
$encrypted_data = encrypt($data);

// Generate the signature
$signature = hash_hmac('sha256', $encrypted_data, $secret_key);

// Store the encrypted data and signature in a cookie
$cookie_value = base64_encode($encrypted_data . '.' . $signature);
setcookie('user_info', $cookie_value, time() + (86400 * 30), '/', 'example.com', true, true);

// Encryption function
function encrypt($data) {
    // Implement your encryption logic here (AES-256, etc.)
    return $encrypted_data;
}

```
